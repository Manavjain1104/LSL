<html>
<head>
    {% include 'logout_button.html' %}
    {% include 'navbar.html' %}
    {% include 'general_styles.html' %}
  <style>
    th:first-of-type {
      border-top-left-radius: 10px;
    }
    th:last-of-type {
      border-top-right-radius: 10px;
    }
    tr:last-of-type td:first-of-type {
      border-bottom-left-radius: 10px;
    }
    tr:last-of-type td:last-of-type {
      border-bottom-right-radius: 10px;
    }

    .leaderboard-table {
      border-collapse: separate;
      width: 100%;
      border-spacing: 0;
      margin: 0 auto;
      max-width: 600px;
    }

    table tr th,
    table tr td {
      border-right: 1px solid #bbb;
      border-bottom: 1px solid #bbb;
      padding: 5px;
    }

    table tr th:first-child,
    table tr td:first-child {
      border-left: 1px solid #bbb;
    }
    table tr th {
      background: #eee;
      text-align: left;
      border-top: solid 1px #bbb;
    }

    /* top-left border-radius */
    table tr:first-child th:first-child {
      border-top-left-radius: 6px;
    }

    /* top-right border-radius */
    table tr:first-child th:last-child {
      border-top-right-radius: 6px;
    }

    /* bottom-left border-radius */
    table tr:last-child td:first-child {
      border-bottom-left-radius: 6px;
    }

    /* bottom-right border-radius */
    table tr:last-child td:last-child {
      border-bottom-right-radius: 6px;
    }
  </style>
  <script src='https://cdn.tailwindcss.com'></script>
</head>
<body>
    <div class="tabs">
        <li class="tab"><a href = "../displaymenu">Menu</a></li>
        <li class="tab"><a href="../checkout">Checkout</a></li>
        <li class="tab active"><a href=".">My Cafe</a></li>
    </div>

    <div class="main-page" style="text-align: center">
        <table class="leaderboard-table">
            <thead>
                <tr>
                  <th><b>Meal</b></th>
                  <th><b>Reservations</b></th>
                </tr>
            </thead>
            {% for meal in meals %}
                <tr>
                    <td>{{meal.name}}</td>
                    <td id="numres{{meal.meal_id}}">{{meal.number_of_reservations}}</td>
                </tr>
            {% endfor %}
        </table>
    </div>
    <br>
    <br>
    <div class="logout-button-section">
        <a href="../../"><button class="logout">Log out</button></a>
</div>

</body>
</html>
<script type="text/javascript">
  console.log('dynamic mycafe happening');

  socket = new WebSocket((window.location.protocol === 'https:' ? 'wss' : 'ws') + '://' + window.location.host + '/ws/dynamicMycafe/');

  socket.onmessage = function(e) {
    console.log('Meal_id Reserved: ' + e.data);
    // console.log(typeof e.data)
    const meal_id = JSON.parse(e.data).message
    console.log(meal_id)
    var numres = document.getElementById("numres" + meal_id);
    if (numres !== null) {
        numres.textContent = (parseInt(numres.textContent) + 1).toString();
    }
};
</script>

